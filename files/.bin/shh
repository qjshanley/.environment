#!/usr/bin/env bash

IFS='' read -r -d '' SCRIPT <<- EOF
bash -l -c "screen -U -DR -S ssh -t host -p 0 ; logout"
EOF

if [ "$#" -eq "1" -a "${1:0:1}" != "-" ] ; then
    # touch the known_hosts file if it doesn't exist
    [ ! -e ~/.ssh/known_hosts ] && mkdir -p ~/.ssh && touch ~/.ssh/known_hosts

    # copy dot files to server
    [ -d ~/.shh/home ] && ( cd ~/.shh/home ; tar czh . ) | ssh "$1" "(cd ~ ; tar xz --overwrite)"

    # attach directly to a screen session
    ssh -t "$1" "$SCRIPT"
else
    # simply pass all args to the ssh command
    ssh "$@"
fi

